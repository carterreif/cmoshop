<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>CMOShop - Updated</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
  <style>
    body { font-family: 'Segoe UI', Arial, sans-serif; background:#f8f9fa; }
    .navbar { background:#fff; box-shadow:0 2px 4px rgba(0,0,0,.06); }
    .hero { position:relative; min-height:42vh; display:flex; align-items:center; color:#fff; }
    .hero::before { content:''; position:absolute; inset:0; background:url('https://images.unsplash.com/photo-1511379938547-c1f69419868d?q=80&w=2070&auto=format&fit=crop') center/cover no-repeat; }
    .hero::after { content:''; position:absolute; inset:0; background:rgba(0,0,0,.35); }
    .hero .container { position:relative; z-index:1; }
    .spacer-bar { height:120px; background:#e9ecef; }
    .newsletter { max-width:720px; margin:0 auto; background:#fff; border-radius:8px; padding:24px; box-shadow:0 2px 8px rgba(0,0,0,.06); }
    .newsletter .btn-success { background:#69b36d; border-color:#69b36d; }
    .logos-strip img { max-height:42px; opacity:.9; filter:grayscale(100%); transition:opacity .2s, filter .2s; }
    .logos-strip img:hover { opacity:1; filter:grayscale(0%); }
    .section-title { text-align:center; font-weight:700; }
    .product-card { background:#fff; border-radius:8px; overflow:hidden; box-shadow:0 2px 6px rgba(0,0,0,.06); height:100%; transition: transform .2s; }
    .product-card:hover { transform: translateY(-4px); }
    .product-image { height: 200px; object-fit: cover; width:100%; }
    .category-badge { background: #eef2f6; color:#495057; padding:4px 10px; border-radius:14px; font-size:.8rem; }
    /* Category tiles */
    .category-card { position: relative; border-radius: 8px; overflow: hidden; box-shadow: 0 2px 8px rgba(0,0,0,.08); cursor: pointer; background:#000; }
    .category-card img { width: 100%; height: 180px; object-fit: cover; opacity: .9; transition: opacity .2s, transform .2s; }
    .category-card:hover img { opacity: 1; transform: scale(1.02); }
    .category-overlay { position: absolute; left:0; right:0; bottom:0; background: rgba(0,0,0,.5); color:#fff; padding: 10px 12px; display:flex; justify-content: space-between; align-items:center; }
    .category-name { font-weight: 700; font-size: .95rem; text-transform: uppercase; letter-spacing: .5px; }
    .category-count { font-size: .8rem; opacity: .9; }
  </style>
  <meta name="description" content="CMOShop - curated gear, merch, and accessories for drummers and metal bands." />
  <meta name="robots" content="index, follow" />
  <link rel="icon" href="data:," />
  
</head>
<body>
  <!-- Navbar -->
  <nav class="navbar navbar-expand-lg sticky-top">
    <div class="container">
      <a class="navbar-brand d-flex align-items-center" href="#">
        <span class="me-2">üè†üéµ</span><strong>CMOShop</strong>
      </a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#nav">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div id="nav" class="collapse navbar-collapse">
        <ul class="navbar-nav me-auto">
          <li class="nav-item"><a class="nav-link" href="#">Home</a></li>
          <li class="nav-item"><a class="nav-link" href="#products">Products</a></li>
          <li class="nav-item"><a class="nav-link" href="#create-link">Create Link</a></li>
          <li class="nav-item"><a class="nav-link" href="#contact">Contact</a></li>
        </ul>
        <div class="d-flex align-items-center gap-2">
          <button class="btn btn-outline-primary" data-bs-toggle="modal" data-bs-target="#loginModal"><i class="fas fa-sign-in-alt me-1"></i>Login</button>
          <a class="btn btn-outline-success position-relative" href="#">
            <i class="fas fa-shopping-cart"></i>
            <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-success">0</span>
          </a>
        </div>
      </div>
    </div>
  </nav>

  <!-- Hero -->
  <section class="hero text-center">
    <div class="container py-5">
      <h1 class="display-6 mb-2">Welcome to CMOShop</h1>
      <p class="lead mb-4">Curated gear, merch, and accessories for drummers and metal bands.</p>
      <div class="input-group mx-auto" style="max-width: 600px;">
        <input type="text" class="form-control" id="searchInput" placeholder="Search for products..." />
        <button class="btn btn-primary" id="searchBtn"><i class="fas fa-search"></i></button>
      </div>
    </div>
  </section>

  <!-- Spacer bar like in screenshot -->
  <div class="spacer-bar"></div>

  <!-- Newsletter -->
  <section class="py-5">
    <div class="container">
      <div class="newsletter">
        <p class="mb-3">If you want more metal drumming updates initialize below</p>
        <form id="newsletterForm" class="row g-2 align-items-center">
          <div class="col-12">
            <label for="newsletterEmail" class="form-label mb-1">Email <span class="text-danger">*</span></label>
            <input type="email" id="newsletterEmail" class="form-control" placeholder="you@example.com" required />
          </div>
          <div class="col-12 mt-2">
            <button type="submit" class="btn btn-success">Initialize</button>
          </div>
        </form>
        <div id="newsletterMsg" class="mt-2 small text-success d-none">Thanks! You'll get updates soon.</div>
      </div>
    </div>
  </section>

  <!-- Brand logos -->
  <section class="py-3">
    <div class="container logos-strip">
      <div class="d-flex flex-wrap justify-content-center gap-4 align-items-center">
        <img data-brand="Sabian" referrerpolicy="no-referrer" crossorigin="anonymous"
             src="https://logo.clearbit.com/sabian.com" alt="Sabian" height="40" />
        <img data-brand="Zildjian" referrerpolicy="no-referrer" crossorigin="anonymous"
             src="https://logo.clearbit.com/zildjian.com" alt="Zildjian" height="40" />
        <img data-brand="Meinl" referrerpolicy="no-referrer" crossorigin="anonymous"
             src="https://logo.clearbit.com/meinl.de" alt="Meinl" height="40" />
        <img data-brand="Remo" referrerpolicy="no-referrer" crossorigin="anonymous"
             src="https://logo.clearbit.com/remo.com" alt="Remo" height="40" />
        <img data-brand="Tama" referrerpolicy="no-referrer" crossorigin="anonymous"
             src="https://logo.clearbit.com/tama.com" alt="Tama" height="40" />
      </div>
    </div>
  </section>

  <!-- Headline -->
  <section class="pt-2 pb-4">
    <div class="container">
      <h2 class="section-title">All Metal Band Products Here</h2>
    </div>
  </section>

  <!-- Category tiles -->
  <section id="categories" class="py-3">
    <div class="container">
      <div class="row g-4" id="categoriesGrid"></div>
    </div>
  </section>

  <!-- Featured products -->
  <section id="products" class="py-4">
    <div class="container">
      <div class="d-flex align-items-center justify-content-between mb-3">
        <h3 id="productsHeading" class="mb-0">Featured Products</h3>
        <button id="resetFiltersBtn" class="btn btn-sm btn-outline-secondary">All Products</button>
      </div>
      <div class="row g-4" id="productsGrid"></div>
    </div>
  </section>

  <!-- Create affiliate link -->
  <section id="create-link" class="py-5 bg-light">
    <div class="container">
      <div class="row justify-content-center">
        <div class="col-md-8">
          <div class="p-4 bg-white rounded shadow-sm">
            <h3 class="text-center mb-3">Create Your Affiliate Link</h3>
            <form id="affiliateLinkForm">
              <div class="mb-3">
                <label class="form-label">Product URL</label>
                <input type="url" class="form-control" id="productUrl" placeholder="https://example.com/product" required />
              </div>
              <div class="mb-3">
                <label class="form-label">Product Name (Optional)</label>
                <input type="text" class="form-control" id="productName" />
              </div>
              <div class="mb-3">
                <label class="form-label">Category</label>
                <select class="form-select" id="category">
                  <option value="">Select a category...</option>
                  <option value="electronics">Electronics</option>
                  <option value="fashion">Fashion</option>
                  <option value="home">Home & Living</option>
                  <option value="beauty">Beauty</option>
                  <option value="other">Other</option>
                </select>
              </div>
              <button type="submit" class="btn btn-primary w-100">Generate Affiliate Link</button>
            </form>
            <div id="affiliateMsg" class="mt-2 small text-primary d-none"></div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Login Modal -->
  <div class="modal fade" id="loginModal" tabindex="-1">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Login</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <form id="loginForm">
            <div class="mb-3">
              <label class="form-label">Email</label>
              <input type="email" class="form-control" required />
            </div>
            <div class="mb-3">
              <label class="form-label">Password</label>
              <input type="password" class="form-control" required />
            </div>
            <button type="submit" class="btn btn-primary w-100">Login</button>
          </form>
        </div>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    // Admin mode toggled by URL param ?admin=1
    const adminMode = new URL(location.href).searchParams.get('admin') === '1';
    // Sample products (with categories resembling screenshot) ‚Äî replace with your real data later
    const products = [
      { id: 1,  name: 'Stay Metal T‚ÄëShirt', description: 'cartersmerchobsession', price: 19.99, image: '/assets/products/stay-metal-shirt.jpg', category: 'CMOProducts', url: '/go/index.html?slug=stay-metal-shirt' },
      { id: 2,  name: 'Disturbed Tee', description: 'Disturbed t-shirt', price: 24.99, image: '/assets/products/disturbed-tee.svg', category: 'Disturbed', url: '/go/index.html?slug=disturbed-tee' },
      { id: 3,  name: 'Beginner Drum Set', description: '5-piece drum kit', price: 299.00, image: '/assets/products/beginner-drum-set.svg', category: 'Drum Sets', url: '/go/index.html?slug=beginner-drum-set' },
      { id: 4,  name: 'Guitar Hero Bundle', description: 'Console game bundle', price: 89.00, image: '/assets/products/guitar-hero.svg', category: 'Guitar Hero', url: '/go/index.html?slug=guitar-hero' },
      { id: 5,  name: 'Megadeth Patch', description: 'Sew-on patch', price: 9.99, image: '/assets/products/megadeth-patch.jpg', category: 'Megadeth', url: '/go/index.html?slug=megadeth-patch' },
      { id: 6,  name: 'Liquid Death Can', description: 'Mountain water', price: 1.99, image: '/assets/products/liquid-death.svg', category: 'Metal Water', url: '/go/index.html?slug=liquid-death' },
      { id: 7,  name: 'Metallica Poster', description: 'Album art poster', price: 14.99, image: '/assets/products/metallica-poster.jpg', category: 'Metallica', url: '/go/index.html?slug=metallica-poster' },
      { id: 8,  name: 'Pantera Sticker', description: 'Logo sticker', price: 4.99, image: '/assets/products/pantera-sticker.svg', category: 'Pantera', url: '/go/index.html?slug=pantera-sticker' },
      { id: 9,  name: 'Metallica Shirt', description: 'Soft cotton tee', price: 22.99, image: '/assets/products/metallica-shirt.jpg', category: 'Metallica', url: '/go/index.html?slug=metallica-shirt' },
      { id: 10, name: 'Disturbed Hoodie', description: 'Pullover hoodie', price: 44.99, image: '/assets/products/disturbed-hoodie.svg', category: 'Disturbed', url: '/go/index.html?slug=disturbed-hoodie' },
      { id: 11, name: "Lars's Drumsticks", description: 'Signature drumsticks', price: 14.99, image: '/assets/products/lars.jpg', category: 'Drum Sticks', url: '/go/index.html?slug=lars-drumsticks' },
      { id: 12, name: 'Lars Ulrich Scary Guy Drumsticks', description: 'Limited edition Scary Guy sticks', price: 17.99, image: '/assets/products/lars.jpg', category: 'Drum Sticks', url: '/go/index.html?slug=lars-scary-guy-sticks' },
      { id: 13, name: 'Guitar Hero', description: 'Guitar Hero game and accessories', price: 49.99, image: 'https://images.unsplash.com/photo-1513105737059-ff0cf0580c07?q=80&w=1200&auto=format&fit=crop', category: 'Guitar Hero', url: '/go/index.html?slug=guitar-hero' },
      { id: 14, name: 'Lizard Skin Bat Grip', description: 'Premium bat grip tape', price: 30.00, image: '/assets/products/lizard-skin-grip.svg', category: 'Baseball Gear', url: '/go/index.html?slug=lizard-skin-grip' },
    ];

    function getOverrideImage(productId, fallback) {
      const key = 'img_' + productId;
      try {
        const val = localStorage.getItem(key);
        if (val) return val; // data URL
      } catch (_) {}
      return fallback;
    }

    function handleUpload(productId) {
      const input = document.createElement('input');
      input.type = 'file';
      input.accept = 'image/*';
      input.onchange = () => {
        const file = input.files && input.files[0];
        if (!file) return;
        const reader = new FileReader();
        reader.onload = () => {
          try {
            localStorage.setItem('img_' + productId, reader.result);
            // Re-render with new image
            renderProducts(currentProductsView);
          } catch (e) {
            alert('Could not save image in this browser (storage limit).');
          }
        };
        reader.readAsDataURL(file);
      };
      input.click();
    }

    function onImgError(productId, name, el) {
      // Graceful placeholder
      el.onerror = null;
      el.src = 'https://via.placeholder.com/600x400?text=' + encodeURIComponent(name);
      // If it's Lars's Drumsticks (id 11) or admin mode, offer quick upload
      if (productId === 11 || adminMode) {
        setTimeout(() => {
          if (confirm('Image missing for ' + name + '. Upload one now?')) {
            handleUpload(productId);
          }
        }, 50);
      }
    }

    let currentProductsView = [];

    function card(p) {
      const imgSrc = getOverrideImage(p.id, p.image);
      return `
        <div class="col-sm-6 col-lg-4">
          <div class="product-card h-100">
            <a href="${p.url || '#'}" target="_blank" rel="nofollow sponsored noopener">
              <img class="product-image" referrerpolicy="no-referrer" crossorigin="anonymous" src="${imgSrc}" alt="${p.name}" onerror="onImgError(${p.id}, '${p.name.replace(/'/g, "\\'")}', this)">
            </a>
            <div class="p-3">
              <h5 class="mb-1"><a href="${p.url || '#'}" class="text-decoration-none" target="_blank" rel="nofollow sponsored noopener">${p.name}</a></h5>
              <p class="text-muted mb-2">${p.description}</p>
              <span class="category-badge">${p.category}</span>
              <div class="d-flex justify-content-between align-items-center mt-3">
                <span class="h6 mb-0">$${p.price}</span>
                <a class="btn btn-primary btn-sm" href="${p.url || '#'}" target="_blank" rel="nofollow sponsored noopener">Buy</a>
              </div>
              <div class="mt-2 text-end"><button class="btn btn-sm btn-outline-secondary" onclick="handleUpload(${p.id})">Upload Image</button></div>
            </div>
          </div>
        </div>`;
    }

    function renderProducts(list) {
      const grid = document.getElementById('productsGrid');
      currentProductsView = list.slice();
      grid.innerHTML = list.map(card).join('');
    }

    // Build categories from products and render tiles
    function buildCategories(products) {
      const byName = new Map();
      products.forEach(p => {
        const key = p.category || 'Other';
        const item = byName.get(key) || { name: key, count: 0, image: p.image };
        item.count += 1;
        if (!item.image) item.image = p.image;
        byName.set(key, item);
      });
      return Array.from(byName.values());
    }

    function categoryTile(cat) {
      const safeImg = cat.image || 'https://via.placeholder.com/400x300?text=' + encodeURIComponent(cat.name);
      return `
        <div class="col-6 col-md-4 col-lg-3">
          <div class="category-card" onclick="filterByCategory('${cat.name.replace(/'/g, "\\'")}')">
            <img src="${safeImg}" alt="${cat.name}" onerror="this.onerror=null;this.src='https://via.placeholder.com/400x300?text=${encodeURIComponent(cat.name)}';">
            <div class="category-overlay">
              <span class="category-name">${cat.name}</span>
              <span class="category-count">${cat.count} product${cat.count!==1?'s':''}</span>
            </div>
          </div>
        </div>`;
    }

    function renderCategories() {
      const cats = buildCategories(products);
      const grid = document.getElementById('categoriesGrid');
      grid.innerHTML = cats.map(categoryTile).join('');
    }

    function filterByCategory(name) {
      const filtered = products.filter(p => (p.category || 'Other') === name);
      renderProducts(filtered);
      const heading = document.getElementById('productsHeading');
      if (heading) heading.textContent = `${name} Products`;
      // Scroll to products section
      document.getElementById('products').scrollIntoView({ behavior: 'smooth' });
    }

    function generateAffiliateLink(id) {
      const p = products.find(x => x.id === id);
      if (!p) return;
      const link = p.url || `https://yourdomain.com/affiliate/${id}`;
      window.open(link, '_blank', 'noopener');
    }

    // Search
    const searchInput = document.getElementById('searchInput');
    const searchBtn = document.getElementById('searchBtn');
    function doSearch() {
      const q = (searchInput.value || '').toLowerCase();
      const filtered = products.filter(p => p.name.toLowerCase().includes(q) || p.description.toLowerCase().includes(q));
      renderProducts(filtered);
    }
    searchBtn.addEventListener('click', doSearch);
    searchInput.addEventListener('keypress', e => { if (e.key === 'Enter') { e.preventDefault(); doSearch(); } });

    // Newsletter
    document.getElementById('newsletterForm').addEventListener('submit', e => {
      e.preventDefault();
      const email = document.getElementById('newsletterEmail').value.trim();
      if (!email) return;
      document.getElementById('newsletterMsg').classList.remove('d-none');
      e.target.reset();
    });

    // Affiliate custom link
    document.getElementById('affiliateLinkForm').addEventListener('submit', e => {
      e.preventDefault();
      const url = document.getElementById('productUrl').value.trim();
      const name = document.getElementById('productName').value.trim();
      const affiliate = `https://yourdomain.com/affiliate/custom?url=${encodeURIComponent(url)}`;
      const msg = document.getElementById('affiliateMsg');
      msg.textContent = `Custom affiliate link${name ? ' for ' + name : ''}: ${affiliate}`;
      msg.classList.remove('d-none');
    });

    // Reset filters button
    document.getElementById('resetFiltersBtn').addEventListener('click', function(){
      renderProducts(products);
      const heading = document.getElementById('productsHeading');
      if (heading) heading.textContent = 'Featured Products';
    });

    // Init
    renderCategories();
    renderProducts(products);

    // Robust fallback for brand logos: if an <img> errors, replace with inline SVG label
    document.querySelectorAll('.logos-strip img').forEach(function(img){
      img.addEventListener('error', function(){
        const brand = img.getAttribute('data-brand') || img.alt || 'Logo';
        const svg = `<?xml version="1.0" encoding="UTF-8"?><svg xmlns="http://www.w3.org/2000/svg" width="140" height="40"><rect width="100%" height="100%" fill="#f1f3f5"/><text x="50%" y="55%" dominant-baseline="middle" text-anchor="middle" font-family="Segoe UI, Arial" font-size="16" fill="#495057">${brand}</text></svg>`;
        img.src = 'data:image/svg+xml;charset=UTF-8,' + encodeURIComponent(svg);
      }, { once: true });
    });
  </script>
</body>
</html>
